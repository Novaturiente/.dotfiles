#+title: Config

* General Settings
#+begin_src emacs-lisp
(require 'hideshow)
(setq doom-font (font-spec :family "JetBrains Mono NL Nerd Font" :size 15))
(when (display-graphic-p)
  (set-face-attribute 'default nil :weight 'semibold))

(add-to-list 'custom-theme-load-path "~/.doom.d/themes")
(load-theme 'doom-rose-pine t)
;; (setq doom-theme 'doom-one)

(setq vterm-shell "/usr/bin/zsh")

(setq display-line-numbers-type t)

(setq confirm-kill-emacs nil)
#+end_src


* Org-mode settings
#+begin_src emacs-lisp

(setq org-directory "~/Notes/Org/")

(custom-theme-set-faces!
;; 'doom-one
'doom-rose-pine
'(org-level-1 :inherit outline-1 :height 1.5)
'(org-level-2 :inherit outline-2 :height 1.4)
'(org-level-3 :inherit outline-3 :height 1.3)
'(org-level-4 :inherit outline-2 :height 1.2)
'(org-level-5 :inherit outline-5 :height 1.1)
'(org-level-6 :inherit outline-6 :height 1.0)
'(org-level-7 :inherit outline-7 :height 1.0)
'(org-level-8 :inherit outline-8 :height 1.0))
;; '(org-document-title :height 1.6 :bold nil :underline nil))

(setq org-modern-table-vertical t)
(setq org-modern-table t)
#+end_src


* Keybindings
#+begin_src emacs-lisp
(map! :leader
      :desc "Open todo.org"
      "o o" (lambda () (interactive) (find-file "~/Org/index.org")))

(map! :leader
      :desc "Kill buffer" "q w" #'kill-current-buffer)

(map! :leader
      :desc "change window" "<left>" #'evil-window-left)
(map! :leader
      :desc "change window" "<right>" #'evil-window-right)

;; Unset existing bindings
(global-unset-key (kbd "M-<left>"))
(global-unset-key (kbd "M-<right>"))
;; Set M-<left> and M-<right> to switch buffers
(global-set-key (kbd "M-<left>") #'previous-buffer)
(global-set-key (kbd "M-<right>") #'next-buffer)

;; Force TAB to insert two spaces in programming modes
(after! prog-mode
  (map! :map prog-mode-map
        :i [tab] (lambda () (interactive) (insert "    "))))
(global-set-key (kbd "TAB") (lambda () (interactive) (insert "    ")))


;; "Open a vterm in a new vertical split window."
(defun my/vterm-open-vertical-split ()
  (interactive)
  (let ((buffer (generate-new-buffer "*vterm*")))
    (split-window-right)  ;; split window vertically
    (other-window 1)      ;; move to new window
    (switch-to-buffer buffer)  ;; switch new window to the new buffer
    (vterm-mode)))        ;; activate vterm mode explicitly

(map! :leader
      (:prefix "t"
       :desc "Open vterm in vertical split" "t" #'my/vterm-open-vertical-split))
#+end_src

#+RESULTS:
: my/open-vterm-vertically


* Python settings
*** Run python file
#+begin_src emacs-lisp
;; Commands
(defun my/uv-run-current-file ()
  "Run `uv run` on the current buffer's file."
  (interactive)
  (let ((file buffer-file-name))
    (unless file
      (user-error "Current buffer is not visiting a file"))
    (compile (format "uv run %s" (shell-quote-argument file)))))

(defun my/uv-run-current-file-with-arg (arg)
  "Prompt for ARG, then run `uv run` on the current file with ARG."
  (interactive (list (read-string "Argument(s) for uv run: ")))
  (let ((file buffer-file-name))
    (unless file
      (user-error "Current buffer is not visiting a file"))
    (compile (format "uv run %s %s"
                     (shell-quote-argument file)
                     arg))))
;; Keybindings only in python buffers
(after! python
  (map! :map python-mode-map
        :leader
        (:prefix ("r" . "run")
         :desc "uv run current file" "r" #'my/uv-run-current-file
         :desc "uv run current file with arg" "a" #'my/uv-run-current-file-with-arg)))
#+end_src


* Completion settings
#+begin_src emacs-lisp
(after! company
  (setq company-idle-delay 0.1)      ;; Show completions instantly as you type
  (setq company-minimum-prefix-length 1)
  (setq company-backends '((company-capf company-files))))

(after! company
  ;; Make TAB confirm selection
  (define-key company-active-map (kbd "TAB") #'company-complete-selection)
  (define-key company-active-map (kbd "<tab>") #'company-complete-selection)

  ;; Make RET insert newline (not accept selection)
  (define-key company-active-map (kbd "RET") nil)
  (define-key company-active-map (kbd "<return>") nil)

  ;; Allow navigation with up/down arrows (usually works by default)
  (define-key company-active-map (kbd "C-j") #'company-select-next)
  (define-key company-active-map (kbd "C-k") #'company-select-previous))

;; Disable lsp documentation
(setq lsp-ui-doc-enable nil lsp-ui-doc-show-with-cursor nil lsp-ui-doc-show-with-mouse nil lsp-eldoc-enable-hover nil lsp-signature-auto-activate nil)
#+end_src
